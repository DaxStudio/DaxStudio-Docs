"use strict";(self.webpackChunkdaxstudio_docusaurus=self.webpackChunkdaxstudio_docusaurus||[]).push([[2739],{8211:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var t=o(74848),r=o(28453);const s={title:"PowerShell Examples"},a="Example 1",l={id:"features/command-line/powershell-examples",title:"PowerShell Examples",description:"When you combine dscmd.exe with powershell you can do some really powerful things like looping through a series of values and outputting a series of files.",source:"@site/docs/features/command-line/powershell-examples.md",sourceDirName:"features/command-line",slug:"/features/command-line/powershell-examples",permalink:"/docs/features/command-line/powershell-examples",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"PowerShell Examples"},sidebar:"tutorialSidebar",previous:{title:"Authentication",permalink:"/docs/features/command-line/authentication"},next:{title:"Syntax",permalink:"/docs/features/command-line/syntax"}},i={},c=[];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["When you combine ",(0,t.jsx)(n.code,{children:"dscmd.exe"})," with powershell you can do some really powerful things like looping through a series of values and outputting a series of files."]}),"\n",(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"example-1",children:"Example 1"})}),"\n",(0,t.jsx)(n.p,{children:"The following example loops through an array of characters and export rows where the 'Product'[Color] value starts with the specified letter. This shows how you can insert a variable from Powershell into your query and filename dynamically."}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["Note that double quote characters ",(0,t.jsx)(n.code,{children:'"'})," inside 'here strings' ",(0,t.jsx)(n.code,{children:'@"..."@'})," need to be double escaping using a backslash and a backtick eg  ",(0,t.jsx)(n.code,{children:'\\`"'})]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"$cmd = \"C:\\Users\\dgosbell\\Downloads\\DaxStudio_3_1_0_portable\\dscmd.exe\"\n$server = \"localhost:50909\"\n$database = \"5389c85e-326d-4e8f-8e42-f2db2fcb98a4\"\n\nforeach ($letter in @(\"B\", \"R\"))\n{\n\n    $query = @\"\n/* START QUERY BUILDER */\nEVALUATE\nSUMMARIZECOLUMNS(\n    'Product'[Category],\n    'Product'[Color],\n    'Product'[Model],\n    Reseller[Business Type],\n    Customer[Country-Region],\n    Customer[State-Province],\n    KEEPFILTERS( FILTER( ALL( 'Product'[Color] ), SEARCH( \\`\"$letter\\`\", 'Product'[Color], 1, 0 ) = 1 )),\n    \\`\"Total Sales\\`\", [Total Sales]\n)\nORDER BY \n    'Product'[Category] ASC,\n    'Product'[Color] ASC,\n    'Product'[Model] ASC,\n    Reseller[Business Type] ASC,\n    Customer[Country-Region] ASC,\n    Customer[State-Province] ASC\n/* END QUERY BUILDER */\n\"@  \n\n    &$cmd csv c:\\temp\\test-$letter.csv -s $server -d $database -q $query\n\n}\n\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>l});var t=o(96540);const r={},s=t.createContext(r);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);