"use strict";(self.webpackChunkdaxstudio_docusaurus=self.webpackChunkdaxstudio_docusaurus||[]).push([[4631],{28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(96540);const r={},i=s.createContext(r);function o(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(i.Provider,{value:t},e.children)}},53692:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/server-timings-executionmetrics-c973fd936e4fa89cfed028646d328395.png"},67024:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/server-timings-tab-153b7aa870f1027cbc270741fe0fc6b8.png"},76695:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"features/traces/server-timings-trace","title":"Server Timing Trace","description":"Tracing requires server admin rights, if you do not have these the trace buttons will be disabled_","source":"@site/docs/features/traces/server-timings-trace.md","sourceDirName":"features/traces","slug":"/features/traces/server-timings-trace","permalink":"/docs/features/traces/server-timings-trace","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Server Timing Trace"},"sidebar":"tutorialSidebar","previous":{"title":"Server Timings Options","permalink":"/docs/features/traces/server-timings-options"},"next":{"title":"Options","permalink":"/docs/category/options"}}');var r=n(74848),i=n(28453);const o={title:"Server Timing Trace"},a=void 0,h={},c=[{value:"Execution Metrics events",id:"execution-metrics-events",level:3}];function d(e){const t={a:"a",admonition:"admonition",em:"em",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.admonition,{type:"tip",children:(0,r.jsx)(t.p,{children:"Tracing requires server admin rights, if you do not have these the trace buttons will be disabled_"})}),"\n",(0,r.jsx)(t.p,{children:"The standard timings reported in the output window is the elapsed time for the query recorded by Dax Studio, but that can be impacted by network speeds and the size of the result set. If you want to see the query timing from the server perspective you can do this with the server timing trace button."}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:n(67024).A+"",width:"856",height:"210"})}),"\n",(0,r.jsx)(t.p,{children:"This button causes an extra tab to be displayed which shows the total time the server spent processing the query as well as the time spent in the Storage Engine and the number of Storage Engine requests for the query."}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Metric"})}),(0,r.jsx)(t.th,{children:(0,r.jsx)(t.strong,{children:"Description"})})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Total"}),(0,r.jsx)(t.td,{children:"This is the total query duration in milliseconds \u2013 taken from the Query End profiler event. This is the total time the server took to process the query. (so it will exclude any time the client took to process the result set)"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"SE CPU"}),(0,r.jsxs)(t.td,{children:["This is the amount of CPU time that was spend on Storage Engine queries (note that this figure ",(0,r.jsx)(t.em,{children:"may"})," not be 100% reliable, so don\u2019t place a high amount of importance on it) the blue ratio under SE CPU is the factor of SE CPU over SE and is a very rough indicator of the average parallel operations that the SE was running. This figure is calculated by adding up the CPU duration from the Storage Engine events"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"FE"}),(0,r.jsx)(t.td,{children:"This is the amount of time spent in the Formula Engine, calculated by Subtracting the SE duration from the Total. The blue figure underneath is the percentage of FE / Total"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"SE"}),(0,r.jsx)(t.td,{children:"This is the amount of time spend in the Storage Engine, calculated by adding up the duration of all the Storage Engine queries. The blue figure underneath is the percentage of SE / Total. As a rough rule of thumb you want to try to get your queries to spend more time in the Storage Engine as it is multi-threaded so can do more operations in parallel. While the Formula Engine is single threaded and cannot make use of multiple CPU cores. Note that you cannot have a query that is 100% handled in the storage engine as the FE sits over the top of the SE. The FE is what issues the requests to the SE and it also serializes the result set before it is sent back to the client"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"SE Queries"}),(0,r.jsx)(t.td,{children:"this is the number of Storage Engine queries that were performed during the processing of the query"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"SE Cache"}),(0,r.jsx)(t.td,{children:"this is the number of Storage Engine cache hits"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"You may also wonder what that \u201cSQL like\u201d query is that captured by the scan event when running a query against an import mode model. This is called xmSQL and is textual representation of the requests that the Formula Engine sent to the Storage Engine. There is no way of executing these queries, they are merely a textual representation of the requests sent to the Storage Engine to enable people to understand what operations the storage engine was performing. When your data model is in Direct Query mode you will see a generic T-SQL query which may be transformed into a more data source specific query before it is executed against the actual data source."}),"\n",(0,r.jsx)(t.h3,{id:"execution-metrics-events",children:"Execution Metrics events"}),"\n",(0,r.jsx)(t.p,{children:"Some data sources like the XMLA endpoint for the Fabric / Power BI service can now emit ExecutionMetrics events. These events output a collection of metrics that can vary based on the type of event. For query events like those captured by server timings these events show information about the query execution such as."}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Number of rows processed for queries and refresh."}),"\n",(0,r.jsx)(t.li,{children:"Time a request got delayed due to capacity throttling."}),"\n",(0,r.jsx)(t.li,{children:"Time to establish a connection to data source."}),"\n",(0,r.jsx)(t.li,{children:"Approximate memory and CPU consumption."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["These events were announced in the following ",(0,r.jsx)(t.a,{href:"https://powerbi.microsoft.com/en-in/blog/new-executionmetrics-event-in-azure-log-analytics-for-power-bi-semantic-models/",children:"blog post"})]}),"\n",(0,r.jsx)(t.admonition,{type:"note",children:(0,r.jsx)(t.p,{children:"As of July 2024 only the XMLA endpoint on the Fabric / Power BI cloud service exposes these events"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{src:n(53692).A+"",width:"1698",height:"551"})})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);